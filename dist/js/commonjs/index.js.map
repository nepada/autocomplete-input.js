{"version":3,"file":"index.js","sources":["../../../src/js/index.js"],"sourcesContent":["import $ from 'jquery';\nimport 'corejs-typeahead/dist/typeahead.jquery';\nimport Bloodhound from 'corejs-typeahead/dist/bloodhound';\n\nfunction defaultTypeaheadFactory(input, options = {}) {\n    const $input = $(input);\n    const autocompleteUrl = $input.data('autocompleteUrl');\n    const autocompleteQueryPlaceholder = $input.data('autocompleteQueryPlaceholder') || '__QUERY_PLACEHOLDER__';\n    const autocompleteMinLength = $input.data('autocompleteMinLength');\n\n    $input.typeahead(\n        $.extend(\n            {\n                highlight: true,\n                autoselect: true,\n                minLength: 1,\n            },\n            options,\n            {\n                minLength: autocompleteMinLength,\n            },\n        ),\n        {\n            source: new Bloodhound({\n                queryTokenizer: Bloodhound.tokenizers.whitespace,\n                datumTokenizer: Bloodhound.tokenizers.whitespace,\n                remote: {\n                    url: autocompleteUrl,\n                    wildcard: autocompleteQueryPlaceholder,\n                },\n            }),\n        },\n    );\n\n    const $hint = $input.parent().find($input.data('ttTypeahead').selectors.hint);\n    // Remove marker data attribute to avoid re-initialization on hint input\n    $hint.removeAttr('data-autocomplete-url');\n    // Remove validation rules from the hint fake input\n    $hint.removeAttr('data-nette-rules');\n}\n\nfunction bootstrap5TypeaheadFactory(input, options = {}) {\n    defaultTypeaheadFactory(\n        input,\n        $.extend(\n            {\n                classNames: {\n                    menu: 'dropdown-menu',\n                    suggestion: 'dropdown-item',\n                    cursor: 'active',\n                },\n            },\n            options,\n        ),\n    );\n\n    const $input = $(input);\n\n    const $wrapper = $input.parent();\n    if ($wrapper.parent().is('.form-floating')) {\n        // Merge with form-floating wrapper, if possible\n        const attrs = Object.fromEntries(Array.from($wrapper.parent().prop('attributes')).map((item) => {return [item.name, item.value];}));\n        attrs.class = $wrapper.attr('class') + ' ' + (attrs.class || '');\n        attrs.style = $wrapper.attr('style') + ' ' + (attrs.style || '');\n        $wrapper.attr(attrs);\n        $wrapper.prevAll().prependTo($wrapper);\n        $wrapper.nextAll().appendTo($wrapper);\n        $wrapper.unwrap();\n    }\n\n    const $hint = $wrapper.find($input.data('ttTypeahead').selectors.hint);\n    // Reset placeholder to make floating labels working\n    $hint.attr({placeholder: ''});\n    // Reset copied background to avoid problems with validation\n    $hint.css({background: 'none'});\n}\n\nfunction initializeForm(form, typeaheadFactory) {\n    $(form)\n        .find('input[data-autocomplete-url]')\n        .each((idx, input) => {\n            if (!$(input).data('ttTypeahead')) {\n                typeaheadFactory(input);\n            }\n        });\n}\n\nfunction initializeAutocomplete(Nette, typeaheadFactory = null) {\n    typeaheadFactory = typeaheadFactory || defaultTypeaheadFactory;\n    // Initialize all forms on document ready\n    $(() => {\n        $('form').each((idx, form) => {\n            initializeForm(form, typeaheadFactory);\n        });\n    });\n\n    // Tap into Nette.initForm() to provide AJAX snippet support via e.g. Naja\n    const originalInitForm = Nette.initForm;\n    Nette.initForm = (form) => {\n        originalInitForm(form);\n        initializeForm(form, typeaheadFactory);\n    };\n}\n\nexport {defaultTypeaheadFactory, bootstrap5TypeaheadFactory};\n\nexport default initializeAutocomplete;\n"],"names":[],"mappings":"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"}
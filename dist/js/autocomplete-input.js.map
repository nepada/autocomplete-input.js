{"version":3,"file":"autocomplete-input.js","sources":["../../src/js/index.js","../../src/js/autocomplete-input.js"],"sourcesContent":["import $ from 'jquery';\nimport 'corejs-typeahead/dist/typeahead.jquery';\nimport Bloodhound from 'corejs-typeahead/dist/bloodhound';\n\nfunction defaultTypeaheadFactory(input, options = {}) {\n    const $input = $(input);\n    const autocompleteUrl = $input.data('autocompleteUrl');\n    const autocompleteQueryPlaceholder = $input.data('autocompleteQueryPlaceholder') || '__QUERY_PLACEHOLDER__';\n    const autocompleteMinLength = $input.data('autocompleteMinLength');\n\n    $input.typeahead(\n        $.extend(\n            {\n                highlight: true,\n                autoselect: true,\n                minLength: 1,\n            },\n            options,\n            {\n                minLength: autocompleteMinLength,\n            },\n        ),\n        {\n            source: new Bloodhound({\n                queryTokenizer: Bloodhound.tokenizers.whitespace,\n                datumTokenizer: Bloodhound.tokenizers.whitespace,\n                remote: {\n                    url: autocompleteUrl,\n                    wildcard: autocompleteQueryPlaceholder,\n                },\n            }),\n        },\n    );\n\n    const $hint = $input.parent().find($input.data('ttTypeahead').selectors.hint);\n    // Remove marker data attribute to avoid re-initialization on hint input\n    $hint.removeAttr('data-autocomplete-url');\n    // Remove validation rules from the hint fake input\n    $hint.removeAttr('data-nette-rules');\n}\n\nfunction bootstrap5TypeaheadFactory(input, options = {}) {\n    defaultTypeaheadFactory(\n        input,\n        $.extend(\n            {\n                classNames: {\n                    menu: 'dropdown-menu',\n                    suggestion: 'dropdown-item',\n                    cursor: 'active',\n                },\n            },\n            options,\n        ),\n    );\n\n    const $input = $(input);\n\n    const $wrapper = $input.parent();\n    if ($wrapper.parent().is('.form-floating')) {\n        // Merge with form-floating wrapper, if possible\n        const attrs = Object.fromEntries(Array.from($wrapper.parent().prop('attributes')).map((item) => {return [item.name, item.value];}));\n        attrs.class = $wrapper.attr('class') + ' ' + (attrs.class || '');\n        attrs.style = $wrapper.attr('style') + ' ' + (attrs.style || '');\n        $wrapper.attr(attrs);\n        $wrapper.prevAll().prependTo($wrapper);\n        $wrapper.nextAll().appendTo($wrapper);\n        $wrapper.unwrap();\n    }\n\n    const $hint = $wrapper.find($input.data('ttTypeahead').selectors.hint);\n    // Reset placeholder to make floating labels working\n    $hint.attr({placeholder: ''});\n    // Reset copied background to avoid problems with validation\n    $hint.css({background: 'none'});\n}\n\nfunction initializeForm(form, typeaheadFactory) {\n    $(form)\n        .find('input[data-autocomplete-url]')\n        .each((idx, input) => {\n            if (!$(input).data('ttTypeahead')) {\n                typeaheadFactory(input);\n            }\n        });\n}\n\nfunction initializeAutocomplete(Nette, typeaheadFactory = null) {\n    typeaheadFactory = typeaheadFactory || defaultTypeaheadFactory;\n    // Initialize all forms on document ready\n    $(() => {\n        $('form').each((idx, form) => {\n            initializeForm(form, typeaheadFactory);\n        });\n    });\n\n    // Tap into Nette.initForm() to provide AJAX snippet support via e.g. Naja\n    const originalInitForm = Nette.initForm;\n    Nette.initForm = (form) => {\n        originalInitForm.apply(Nette, [form]);\n        initializeForm(form, typeaheadFactory);\n    };\n}\n\nexport {defaultTypeaheadFactory, bootstrap5TypeaheadFactory};\n\nexport default initializeAutocomplete;\n","import Nette from 'nette-forms';\nimport initializeAutocomplete from './index';\n\ninitializeAutocomplete(Nette);\n"],"names":["defaultTypeaheadFactory","input","options","arguments","length","undefined","$input","$","autocompleteUrl","data","autocompleteQueryPlaceholder","autocompleteMinLength","typeahead","extend","highlight","autoselect","minLength","source","Bloodhound","queryTokenizer","tokenizers","whitespace","datumTokenizer","remote","url","wildcard","$hint","parent","find","selectors","hint","removeAttr","initializeForm","form","typeaheadFactory","each","idx","initializeAutocomplete","Nette","originalInitForm","initForm","apply"],"mappings":"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"}